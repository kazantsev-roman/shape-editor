(this["webpackJsonpshape-editor"]=this["webpackJsonpshape-editor"]||[]).push([[0],{11:function(e,t,n){e.exports={button:"Button_button__3GztG",text:"Button_text__3ZMjl"}},14:function(e,t,n){e.exports={canvasWrap:"View_canvasWrap__3l6n3"}},15:function(e,t,n){e.exports={wrap:"Popup_wrap__3kESB"}},24:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),a=n(13),r=n.n(a),c=(n(24),n(14)),s=n.n(c),u=n(7),h={canvasWidth:640,canvasHeight:480,fillColor:"gray",outlineColor:"#000"},l=n(0);var d=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,o=t.width,a=t.height;return Object(l.jsx)("polygon",{x:n,y:i,points:"".concat(n," ").concat(i+a,",  \n\t\t\t\t ").concat(n+o/2," ").concat(i,", \n\t\t\t\t ").concat(n+o," ").concat(i+a," "),fill:h.fillColor,stroke:h.outlineColor})};var f=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,o=t.width,a=t.height;return Object(l.jsx)("rect",{x:n,y:i,width:o,height:a,fill:h.fillColor,stroke:h.outlineColor})};var v=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,o=t.width,a=t.height;return Object(l.jsx)("ellipse",{cx:n+o/2,cy:i+a/2,rx:o/2,ry:a/2,fill:h.fillColor,stroke:h.outlineColor})};var m=function(e){var t=e.path,n=e.frame,i=n.leftTopPoint.x,o=n.leftTopPoint.y,a=n.width,r=n.height;return Object(l.jsx)("image",{x:i,y:o,width:a,height:r,xlinkHref:t})};var p=function(e){return void 0!==e.GetPath};var j=function(e){var t=e.item,n=e.frame;switch(t.GetType()){case"Triangle":return Object(l.jsx)(d,{frame:n});case"Rectangle":return Object(l.jsx)(f,{frame:n});case"Ellipse":return Object(l.jsx)(v,{frame:n});case"Image":if(p(t))return Object(l.jsx)(m,{path:t.GetPath(),frame:n})}return null};var g=function(e,t,n,o){var a,r,c=!1;Object(i.useEffect)((function(){var t=e.current;return null===t||void 0===t||t.addEventListener("mousedown",s),function(){null===t||void 0===t||t.removeEventListener("mousedown",s)}}));var s=function(e){c=!1,a={x:e.pageX,y:e.pageY},null===t||void 0===t||t(a),document.addEventListener("mousemove",u),document.addEventListener("mouseup",h)},u=function(e){c=!0;var t={x:e.pageX-a.x,y:e.pageY-a.y};null===n||void 0===n||n(t),r=t},h=function e(){c&&(null===o||void 0===o||o(r)),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",e)}};var y=function(e,t,n,i,o){g(e,(function(){}),(function(t){var o,a={width:n.width+t.x,height:n.height+t.y};null!==(o=e.current)&&void 0!==o&&o.getBoundingClientRect()&&(t.x=n.width+t.x<1?1:n.leftTopPoint.x+n.width+t.x>h.canvasWidth?h.canvasWidth-n.leftTopPoint.x:a.width,t.y=n.height+t.y<1?1:n.leftTopPoint.y+n.height+t.y>h.canvasHeight?h.canvasHeight-n.leftTopPoint.y:a.height),i({width:t.x,height:t.y})}),(function(e){o(t,{width:e.x,height:e.y})}))};var b=function(e){var t=e.selectItem,n=e.setSize,o=e.resizeItem,a=e.frame,r=Object(i.useRef)(null);return y(r,t.GetId(),a,n,o),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("rect",{x:a.leftTopPoint.x-5,y:a.leftTopPoint.y-5,width:a.width+10,height:a.height+10,stroke:"#1f74d7",fill:"#000",fillOpacity:"0",strokeWidth:1}),Object(l.jsx)("circle",{ref:r,cx:a.leftTopPoint.x+a.width+5,cy:a.leftTopPoint.y+a.height+5,r:4,fill:"#000"})]})};var x=function(e,t,n,i,o,a){g(e,o,(function(t){var o,a,r,c,s;null!==(o=e.current)&&void 0!==o&&o.getBoundingClientRect()&&(t.x=n.x+t.x<0?0:n.x+t.x>h.canvasWidth-(null===(a=e.current)||void 0===a?void 0:a.getBoundingClientRect().width)?h.canvasWidth-(null===(r=e.current)||void 0===r?void 0:r.getBoundingClientRect().width):n.x+t.x,t.y=n.y+t.y<0?0:n.y+t.y>h.canvasHeight-(null===(c=e.current)||void 0===c?void 0:c.getBoundingClientRect().height)?h.canvasHeight-(null===(s=e.current)||void 0===s?void 0:s.getBoundingClientRect().height):n.y+t.y);i(t)}),(function(e){a(t,e)}))};var O=function(e,t){Object(i.useEffect)((function(){return document.addEventListener("click",n,!0),function(){document.removeEventListener("click",n,!0)}}));var n=function(n){e.current&&!e.current.contains(n.target)&&t()}};var k=function(e,t){return o.a.isValidElement(e)?o.a.cloneElement(e,t):e};var w=function(e){var t=e.item,n=e.selectItem,o=e.setSelectItem,a=e.resizeItem,r=e.moveItem,c=e.children,s=Object(i.useRef)(null),h=t.GetFrame().leftTopPoint.x,d=t.GetFrame().leftTopPoint.y,f=t.GetFrame().width,v=t.GetFrame().height,m=Object(i.useState)({x:h,y:d}),p=Object(u.a)(m,2),j=p[0],g=p[1],y=Object(i.useState)({width:f,height:v}),w=Object(u.a)(y,2),E=w[0],I=w[1],C=function(){o(t)};return Object(i.useEffect)((function(){var e=s.current;return null===e||void 0===e||e.addEventListener("click",C),function(){null===e||void 0===e||e.removeEventListener("click",C)}})),Object(i.useEffect)((function(){g({x:h,y:d})}),[h,d]),Object(i.useEffect)((function(){I({width:f,height:v})}),[f,v]),O(s,(function(){o(null)})),x(s,t.GetId(),j,g,(function(){o(t)}),r),Object(l.jsxs)(l.Fragment,{children:[(null===n||void 0===n?void 0:n.GetId())===t.GetId()&&Object(l.jsx)(b,{selectItem:n,setSize:I,resizeItem:a,frame:{leftTopPoint:j,width:E.width,height:E.height}}),Object(l.jsx)("g",{ref:s,children:k(c,{frame:{leftTopPoint:j,width:E.width,height:E.height}})})]})};var E=function(e){var t=e.items,n=e.resizeItem,o=e.moveItem,a=e.deleteItem,r=Object(i.useState)(null),c=Object(u.a)(r,2),s=c[0],d=c[1],f=function(e){"Delete"===e.key&&s&&a(s.GetId())};return Object(i.useEffect)((function(){return document.addEventListener("keyup",f),function(){document.removeEventListener("keyup",f)}})),Object(l.jsxs)("svg",{baseProfile:"full",width:h.canvasWidth,height:h.canvasHeight,children:[Object(l.jsx)("rect",{width:"100%",height:"100%",fill:"white"}),t.map((function(e){return Object(l.jsx)(w,{item:e,selectItem:s,setSelectItem:d,resizeItem:n,moveItem:o,children:Object(l.jsx)(j,{item:e,frame:e.GetFrame()})},e.GetId())}))]})},I=n(6),C=n.n(I),R=n(11),_=n.n(R),T=n(15),U=n.n(T);var P=function(e){var t=e.visible,n=e.indent,o=e.setColor,a=e.children;return Object(i.useEffect)((function(){return t&&o("#7e8a97"),function(){o("#cbaf87")}}),[t,o]),Object(l.jsx)("div",{className:U.a.wrap,style:{display:t?"block":"none",left:"".concat(n,"px")},children:a.map((function(e){return e}))})};var G=function(e){var t=e.text,n=e.indent,o=e.children,a=function(e){var t=Object(i.useState)(e),n=Object(u.a)(t,2),o=n[0],a=n[1],r=Object(i.useRef)(null),c=function(e){r.current&&!r.current.contains(e.target)&&a(!1)};return Object(i.useEffect)((function(){return document.addEventListener("click",c,!0),function(){document.removeEventListener("click",c,!0)}})),{ref:r,isComponentVisible:o,setIsComponentVisible:a}}(!1),r=a.ref,c=a.isComponentVisible,s=a.setIsComponentVisible,h=Object(i.useState)("#cbaf87"),d=Object(u.a)(h,2),f=d[0],v=d[1];return Object(l.jsxs)("div",{ref:r,className:_.a.button,onClick:function(){s(!c)},onMouseMove:function(){v("#7e8a97")},onMouseLeave:function(){c||v("#cbaf87")},style:{backgroundColor:f},children:[Object(l.jsx)("span",{className:_.a.text,children:t}),Object(l.jsx)(P,{visible:c,indent:n,setColor:v,children:o.map((function(e){return e}))})]})},S=n(8),z=n.n(S);var H=function(e){var t=e.imageUrl,n=e.text,i=e.action;return Object(l.jsxs)("div",{className:z.a.wrap,onClick:function(){i()},children:[Object(l.jsx)("img",{className:z.a.image,src:t,alt:""}),Object(l.jsx)("div",{className:z.a.text,children:n})]})};var N=function(e){var t=e.imageUrl,n=e.text,o=e.action,a=Object(i.useRef)(null);return Object(l.jsxs)("div",{className:z.a.wrap,onClick:function(){a.current&&a.current.click()},children:[Object(l.jsx)("input",{type:"file",hidden:!0,accept:"image/png, image/gif, image/jpeg",ref:a,onChange:function(e){o(URL.createObjectURL(e.target.files[0]))}}),Object(l.jsx)("img",{className:z.a.image,src:t,alt:""}),Object(l.jsx)("div",{className:z.a.text,children:n})]})};var D=function(e){var t=e.addTriangle,n=e.addRectangle,o=e.addEllipse,a=e.addImage,r=e.canUndo,c=e.undo,s=e.canRedo,u=e.redo,h=function(e){console.log(e.key),"R"===e.key.toUpperCase()&&n(),"E"!==e.key.toUpperCase()&&"C"!==e.key.toUpperCase()||o(),"T"===e.key.toUpperCase()&&t()};return Object(i.useEffect)((function(){return document.addEventListener("keyup",h),function(){document.removeEventListener("keyup",h)}})),Object(l.jsxs)("div",{className:C.a.wrap,children:[Object(l.jsxs)(G,{text:"Insert",indent:15,children:[Object(l.jsx)(H,{imageUrl:"images/triangle.png",text:"Triangle",action:t}),Object(l.jsx)(H,{imageUrl:"images/rectangle.png",text:"Rectangle",action:n}),Object(l.jsx)(H,{imageUrl:"images/ellipse.png",text:"Ellipse",action:o}),Object(l.jsx)(N,{imageUrl:"images/image.png",text:"Image",action:a})]}),Object(l.jsxs)("div",{className:C.a.history,children:[Object(l.jsx)("img",{className:r()?C.a.image+" "+C.a.imageUndo+" "+C.a.imageHoverUndo:C.a.image+" "+C.a.imageUndo+" "+C.a.withOpacity,src:"images/undo.png",alt:"",onClick:function(){r()&&c()}}),Object(l.jsx)("img",{className:s()?C.a.image+" "+C.a.imageRedo+" "+C.a.imageHoverRedo:C.a.image+" "+C.a.imageRedo+" "+C.a.withOpacity,src:"images/redo.png",alt:"",onClick:function(){s()&&u()}})]})]})};var A=function(e){var t=e.controller,n=e.items;return Object(l.jsxs)("div",{children:[Object(l.jsx)(D,{addTriangle:function(){t.AddShape("Triangle")},addRectangle:function(){t.AddShape("Rectangle")},addEllipse:function(){t.AddShape("Ellipse")},addImage:function(e){t.AddImage(e)},canUndo:function(){return t.CanUndo()},undo:function(){t.Undo()},canRedo:function(){return t.CanRedo()},redo:function(){t.Redo()}}),Object(l.jsx)("div",{className:s.a.canvasWrap,children:Object(l.jsx)(E,{items:n,deleteItem:function(e){t.DeleteItem(e)},resizeItem:function(e,n){t.ResizeItem(e,n)},moveItem:function(e,n){t.MoveItem(e,n)}})})]})},L=n(2),F=n(3),M=function(){function e(){Object(L.a)(this,e),this.MAX_DEPTH_OF_HISTORY=20,this.undo=[],this.redo=[]}return Object(F.a)(e,[{key:"CanRedo",value:function(){return this.redo.length>0}},{key:"CanUndo",value:function(){return this.undo.length>0}},{key:"Redo",value:function(){if(!this.CanRedo())throw Error("CAN'T REDO");var e=this.redo.pop();void 0!==e&&(this.undo.push(e),e.Execute())}},{key:"Undo",value:function(){if(!this.CanUndo())throw Error("CAN'T UNDO");var e=this.undo.pop();void 0!==e&&(this.redo.push(e),e.UnExecute())}},{key:"ExecuteCommand",value:function(e){e.Execute(),this.AddExecutedCommand(e)}},{key:"AddExecutedCommand",value:function(e){this.redo=[],this.undo.length>=this.MAX_DEPTH_OF_HISTORY&&this.undo.shift(),this.undo.push(e)}}]),e}(),B=n(5),W=n(4),V=function(){function e(){Object(L.a)(this,e),this.executed=!1}return Object(F.a)(e,[{key:"Execute",value:function(){this.DoExecute(),this.executed=!0}},{key:"UnExecute",value:function(){this.DoUnExecute(),this.executed=!1}},{key:"IsExecuted",value:function(){return this.executed}}]),e}(),Y=n(27),X=function(){function e(){Object(L.a)(this,e),this.frame=void 0,this.frame={leftTopPoint:{x:50,y:50},width:200,height:100}}return Object(F.a)(e,[{key:"GetFrame",value:function(){return this.frame}},{key:"Move",value:function(e){this.frame.leftTopPoint=e}},{key:"Resize",value:function(e){this.frame.width=e.width,this.frame.height=e.height}}]),e}(),J=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(){var e;Object(L.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).type="Rectangle",e.id=Object(Y.a)(),e}return Object(F.a)(n,[{key:"GetType",value:function(){return this.type}},{key:"GetId",value:function(){return this.id}}]),n}(X),q=J,Q=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(){var e;Object(L.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).type="Triangle",e.id=Object(Y.a)(),e}return Object(F.a)(n,[{key:"GetType",value:function(){return this.type}},{key:"GetId",value:function(){return this.id}}]),n}(X),Z=Q,K=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(){var e;Object(L.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).type="Ellipse",e.id=Object(Y.a)(),e}return Object(F.a)(n,[{key:"GetType",value:function(){return this.type}},{key:"GetId",value:function(){return this.id}}]),n}(X),$=K,ee=function(){function e(){Object(L.a)(this,e)}return Object(F.a)(e,[{key:"CreateShape",value:function(e){if("Rectangle"===e)return new q;if("Triangle"===e)return new Z;if("Ellipse"===e)return new $;throw Error("Error shape type")}}]),e}(),te=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(e,i){var o;return Object(L.a)(this,n),(o=t.call(this)).shapes=void 0,o.shape=void 0,o.shapes=e,o.shape=(new ee).CreateShape(i),o}return Object(F.a)(n,[{key:"DoExecute",value:function(){this.shapes.push(this.shape)}},{key:"DoUnExecute",value:function(){if(!this.IsExecuted())throw Error("???");this.shapes.pop()}}]),n}(V),ne=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(e,i){var o;return Object(L.a)(this,n),(o=t.call(this)).shapes=void 0,o.position=0,o.shape=null,o.shapes=e,o.position=o.shapes.findIndex((function(e){return e.GetId()===i})),o}return Object(F.a)(n,[{key:"DoExecute",value:function(){if(this.position>-1)return this.shape=this.shapes[this.position],void this.shapes.splice(this.position,1);throw Error("incorrect id")}},{key:"DoUnExecute",value:function(){if(!this.IsExecuted()||!this.shape)throw Error("???");this.shapes.splice(this.position,0,this.shape)}}]),n}(V),ie=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(e,i,o){var a;return Object(L.a)(this,n),(a=t.call(this)).shapes=void 0,a.shape=void 0,a.newSize=void 0,a.oldSize={width:0,height:0},a.shapes=e,a.newSize=i,a.shape=a.shapes.find((function(e){return e.GetId()===o})),a}return Object(F.a)(n,[{key:"DoExecute",value:function(){var e;this.oldSize=this.shape?{width:this.shape.GetFrame().width,height:this.shape.GetFrame().height}:this.oldSize,null===(e=this.shape)||void 0===e||e.Resize(this.newSize)}},{key:"DoUnExecute",value:function(){if(!this.IsExecuted())throw Error("???");var e;null===(e=this.shape)||void 0===e||e.Resize(this.oldSize)}}]),n}(V),oe=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(e,i,o){var a;return Object(L.a)(this,n),(a=t.call(this)).shapes=void 0,a.shape=void 0,a.newPoint=void 0,a.oldPoint={x:0,y:0},a.shapes=e,a.newPoint=i,a.shape=a.shapes.find((function(e){return e.GetId()===o})),a}return Object(F.a)(n,[{key:"DoExecute",value:function(){var e;this.oldPoint=this.shape?this.shape.GetFrame().leftTopPoint:this.oldPoint,null===(e=this.shape)||void 0===e||e.Move(this.newPoint)}},{key:"DoUnExecute",value:function(){if(!this.IsExecuted())throw Error("???");var e;null===(e=this.shape)||void 0===e||e.Move(this.oldPoint)}}]),n}(V),ae=function(){function e(t){Object(L.a)(this,e),this.id=void 0,this.frame=void 0,this.type="Image",this.path=void 0,this.path=t,this.id=Object(Y.a)(),this.frame={leftTopPoint:{x:50,y:50},width:100,height:100}}return Object(F.a)(e,[{key:"GetType",value:function(){return this.type}},{key:"GetPath",value:function(){return this.path}},{key:"GetId",value:function(){return this.id}},{key:"GetFrame",value:function(){return this.frame}},{key:"Move",value:function(e){this.frame.leftTopPoint=e}},{key:"Resize",value:function(e){this.frame.width=e.width,this.frame.height=e.height}}]),e}(),re=function(e){Object(B.a)(n,e);var t=Object(W.a)(n);function n(e,i,o){var a;return Object(L.a)(this,n),(a=t.call(this)).shapes=void 0,a.shape=void 0,a.shapes=e,a.shape=new ae(o),a}return Object(F.a)(n,[{key:"DoExecute",value:function(){this.shapes.push(this.shape)}},{key:"DoUnExecute",value:function(){if(!this.IsExecuted())throw Error("???");this.shapes.pop()}}]),n}(V),ce=function(){function e(){Object(L.a)(this,e),this.items=[],this.observers=[],this.history=void 0,this.history=new M}return Object(F.a)(e,[{key:"GetItems",value:function(){return this.items}},{key:"AddShape",value:function(e,t){var n=void 0!==t?new re(this.items,e,t):new te(this.items,e);this.history.ExecuteCommand(n),this.NotifyObservers()}},{key:"DeleteShape",value:function(e){var t=new ne(this.items,e);this.history.ExecuteCommand(t),this.NotifyObservers()}},{key:"ResizeShape",value:function(e,t){var n=new ie(this.items,t,e);this.history.ExecuteCommand(n),this.NotifyObservers()}},{key:"MoveShape",value:function(e,t){var n=new oe(this.items,t,e);this.history.ExecuteCommand(n),this.NotifyObservers()}},{key:"CanUndo",value:function(){return this.history.CanUndo()}},{key:"Undo",value:function(){this.history.Undo(),this.NotifyObservers()}},{key:"CanRedo",value:function(){return this.history.CanRedo()}},{key:"Redo",value:function(){this.history.Redo(),this.NotifyObservers()}},{key:"RegisterObserver",value:function(e){this.observers.push(e)}},{key:"RemoveObserver",value:function(e){this.observers.filter((function(t){return t!==e}))}},{key:"NotifyObservers",value:function(){this.observers.forEach((function(e){return e()}))}}]),e}(),se=function(){function e(t){Object(L.a)(this,e),this.model=void 0,this.model=t}return Object(F.a)(e,[{key:"GetShapes",value:function(){return this.model.GetItems()}},{key:"AddShape",value:function(e){this.model.AddShape(e)}},{key:"AddImage",value:function(e){this.model.AddShape("Image",e)}},{key:"DeleteItem",value:function(e){this.model.DeleteShape(e)}},{key:"MoveItem",value:function(e,t){this.model.MoveShape(e,t)}},{key:"ResizeItem",value:function(e,t){this.model.ResizeShape(e,t)}},{key:"CanUndo",value:function(){return this.model.CanUndo()}},{key:"Undo",value:function(){this.model.Undo()}},{key:"CanRedo",value:function(){return this.model.CanRedo()}},{key:"Redo",value:function(){this.model.Redo()}}]),e}(),ue=r.a.createRoot(document.getElementById("root")),he=new ce,le=new se(he);function de(){ue.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(A,{items:he.GetItems(),controller:le})}))}he.RegisterObserver(de),de()},6:function(e,t,n){e.exports={wrap:"Header_wrap__3D2ds",image:"Header_image__15xHu",imageUndo:"Header_imageUndo__1HnuQ",imageRedo:"Header_imageRedo__2hSh7",withOpacity:"Header_withOpacity__1NG3b",imageHoverUndo:"Header_imageHoverUndo__1zzpq",imageHoverRedo:"Header_imageHoverRedo__2YPc1"}},8:function(e,t,n){e.exports={wrap:"Element_wrap__1rprF",image:"Element_image__2D8Ax",text:"Element_text__2tchm"}}},[[26,1,2]]]);
//# sourceMappingURL=main.27d3cf80.chunk.js.map