(this["webpackJsonpshape-editor"]=this["webpackJsonpshape-editor"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports={wrap:"Header_wrap__3D2ds",image:"Header_image__15xHu",imageUndo:"Header_imageUndo__1HnuQ",imageRedo:"Header_imageRedo__2hSh7",withOpacity:"Header_withOpacity__1NG3b",imageHoverUndo:"Header_imageHoverUndo__1zzpq",imageHoverRedo:"Header_imageHoverRedo__2YPc1"}},,function(e,t,n){e.exports={wrap:"Element_wrap__1rprF",image:"Element_image__2D8Ax",text:"Element_text__2tchm"}},,,function(e,t,n){e.exports={button:"Button_button__3GztG",text:"Button_text__3ZMjl"}},,,function(e,t,n){e.exports={canvasWrap:"View_canvasWrap__3l6n3"}},function(e,t,n){e.exports={circle:"Circle_circle__r1puc"}},function(e,t,n){e.exports={wrap:"Popup_wrap__3kESB"}},,,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var i=n(2),a=n(3),o=n(1),c=n.n(o),r=n(13),s=n.n(r),u=(n(25),n(7)),l=n(14),h=n.n(l),d={canvasWidth:640,canvasHeight:480,fillColor:"gray",outlineColor:"#000"},f=n(0);var v=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,a=t.width,o=t.height;return Object(f.jsx)("polygon",{x:n,y:i,points:"".concat(n," ").concat(i+o,",  \n\t\t\t\t ").concat(n+a/2," ").concat(i,", \n\t\t\t\t ").concat(n+a," ").concat(i+o," "),fill:d.fillColor,stroke:d.outlineColor})};var m=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,a=t.width,o=t.height;return Object(f.jsx)("rect",{x:n,y:i,width:a,height:o,fill:d.fillColor,stroke:d.outlineColor})};var p=function(e){var t=e.frame,n=t.leftTopPoint.x,i=t.leftTopPoint.y,a=t.width,o=t.height;return Object(f.jsx)("ellipse",{cx:n+a/2,cy:i+o/2,rx:a/2,ry:o/2,fill:d.fillColor,stroke:d.outlineColor})};var j=function(e){var t=e.path,n=e.frame,i=n.leftTopPoint.x,a=n.leftTopPoint.y,o=n.width,c=n.height;return Object(f.jsx)("image",{preserveAspectRatio:"none",x:i,y:a,width:o,height:c,xlinkHref:t})};var g,b=function(e){return void 0!==e.GetPath};!function(e){e.Rectangle="Rectangle",e.Triangle="Triangle",e.Ellipse="Ellipse",e.Image="Image"}(g||(g={}));var x=g;var O=function(e){var t=e.item,n=e.frame;switch(t.GetType()){case x.Triangle:return Object(f.jsx)(v,{frame:n});case x.Rectangle:return Object(f.jsx)(m,{frame:n});case x.Ellipse:return Object(f.jsx)(p,{frame:n});case x.Image:if(b(t))return Object(f.jsx)(j,{path:t.GetPath(),frame:n})}return null};var y=function(e){var t=e.frame;return Object(f.jsx)("rect",{x:t.leftTopPoint.x,y:t.leftTopPoint.y,width:t.width,height:t.height,stroke:"#ff0000",fill:"#000",fillOpacity:"0",strokeWidth:1})};var w=function(e,t,n,i){var a,c,r=!1;Object(o.useEffect)((function(){var t=e.current;return null===t||void 0===t||t.addEventListener("mousedown",s),function(){null===t||void 0===t||t.removeEventListener("mousedown",s)}}));var s=function(e){r=!1,a={x:e.pageX,y:e.pageY},null===t||void 0===t||t(a),document.addEventListener("mousemove",u),document.addEventListener("mouseup",l)},u=function(e){r=!0;var t={x:e.pageX-a.x,y:e.pageY-a.y};null===n||void 0===n||n(t),c=t},l=function e(){r&&(null===i||void 0===i||i(c)),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",e)}};var E=function(e,t,n,i,a,o){w(e,a,(function(t){var a,o=null===(a=e.current)||void 0===a?void 0:a.getBoundingClientRect();o&&(t.x=n.x+t.x<0?0:n.x+t.x>d.canvasWidth-o.width?d.canvasWidth-o.width:n.x+t.x,t.y=n.y+t.y<0?0:n.y+t.y>d.canvasHeight-o.height?d.canvasHeight-o.height:n.y+t.y),i(t)}),(function(e){o(t,e)}))};var k=function(e,t){Object(o.useEffect)((function(){return document.addEventListener("click",n,!0),function(){document.removeEventListener("click",n,!0)}}));var n=function(n){e.current&&!e.current.contains(n.target)&&t()}};var I=function(e,t){return c.a.isValidElement(e)?c.a.cloneElement(e,t):e},R=n(15),C=n.n(R);var _=function(e,t,n,i,a){w(e,(function(){}),(function(e){e.x=n.width+e.x<1?1:n.leftTopPoint.x+n.width+e.x>d.canvasWidth?d.canvasWidth-n.leftTopPoint.x:n.width+e.x,e.y=n.height+e.y<1?1:n.leftTopPoint.y+n.height+e.y>d.canvasHeight?d.canvasHeight-n.leftTopPoint.y:n.height+e.y,i({width:e.x,height:e.y})}),(function(e){a(t,{width:e.x,height:e.y})}))};function T(e){var t=e.selectItem,n=e.setSize,i=e.resizeItem,a=e.frame,c=Object(o.useRef)(null);return _(c,t.GetId(),a,n,i),Object(f.jsx)("circle",{className:C.a.circle,ref:c,cx:a.leftTopPoint.x+a.width,cy:a.leftTopPoint.y+a.height,r:4,fill:"#000"})}var U=function(e){var t=e.item,n=e.selectItem,i=e.setSelectItem,a=e.resizeItem,c=e.moveItem,r=e.children,s=Object(o.useRef)(null),l=Object(o.useRef)(null),h=t.GetFrame().leftTopPoint.x,d=t.GetFrame().leftTopPoint.y,v=t.GetFrame().width,m=t.GetFrame().height,p=Object(o.useState)({x:h,y:d}),j=Object(u.a)(p,2),g=j[0],b=j[1],x=Object(o.useState)({width:v,height:m}),O=Object(u.a)(x,2),w=O[0],R=O[1],C=function(){i(t)};return Object(o.useEffect)((function(){var e=s.current;return null===e||void 0===e||e.addEventListener("click",C),function(){null===e||void 0===e||e.removeEventListener("click",C)}})),Object(o.useEffect)((function(){b({x:h,y:d})}),[h,d]),Object(o.useEffect)((function(){R({width:v,height:m})}),[v,m]),k(l,(function(){i(null)})),E(s,t.GetId(),g,b,(function(){i(t)}),c),Object(f.jsxs)("g",{ref:l,children:[Object(f.jsxs)("g",{ref:s,children:[I(r,{frame:{leftTopPoint:g,width:w.width,height:w.height}}),(null===n||void 0===n?void 0:n.GetId())===t.GetId()&&Object(f.jsx)(y,{frame:{leftTopPoint:g,width:w.width,height:w.height}})]}),(null===n||void 0===n?void 0:n.GetId())===t.GetId()&&Object(f.jsx)(T,{selectItem:n,setSize:R,resizeItem:a,frame:{leftTopPoint:g,width:w.width,height:w.height}})]})};var P=function(e){var t=e.items,n=e.resizeItem,i=e.moveItem,a=e.selectItem,o=e.setSelectItem;return Object(f.jsxs)("svg",{baseProfile:"full",width:d.canvasWidth,height:d.canvasHeight,children:[Object(f.jsx)("rect",{width:"100%",height:"100%",fill:"white"}),t.map((function(e){return Object(f.jsx)(U,{item:e,selectItem:a,setSelectItem:o,resizeItem:n,moveItem:i,children:Object(f.jsx)(O,{item:e,frame:e.GetFrame()})},e.GetId())}))]})},G=n(6),S=n.n(G),H=n(11),z=n.n(H),D=n(16),A=n.n(D);var N=function(e){var t=e.visible,n=e.indent,i=e.setColor,a=e.children;return Object(o.useEffect)((function(){return t&&i("#7e8a97"),function(){i("#cbaf87")}}),[t,i]),Object(f.jsx)("div",{className:A.a.wrap,style:{display:t?"block":"none",left:"".concat(n,"px")},children:a.map((function(e){return e}))})};var L=function(e){var t=e.text,n=e.indent,i=e.children,a=function(e){var t=Object(o.useState)(e),n=Object(u.a)(t,2),i=n[0],a=n[1],c=Object(o.useRef)(null);Object(o.useEffect)((function(){return document.addEventListener("click",r,!0),function(){document.removeEventListener("click",r,!0)}}));var r=function(e){c.current&&!c.current.contains(e.target)&&a(!1)};return{ref:c,isComponentVisible:i,setIsComponentVisible:a}}(!1),c=a.ref,r=a.isComponentVisible,s=a.setIsComponentVisible,l=Object(o.useState)("#cbaf87"),h=Object(u.a)(l,2),d=h[0],v=h[1];return Object(f.jsxs)("div",{ref:c,className:z.a.button,onClick:function(){s(!r)},onMouseMove:function(){v("#7e8a97")},onMouseLeave:function(){r||v("#cbaf87")},style:{backgroundColor:d},children:[Object(f.jsx)("span",{className:z.a.text,children:t}),Object(f.jsx)(N,{visible:r,indent:n,setColor:v,children:i.map((function(e){return e}))})]})},F=n(8),M=n.n(F);var W=function(e){var t=e.imageUrl,n=e.text,i=e.action;return Object(f.jsxs)("div",{className:M.a.wrap,onClick:function(){i()},children:[Object(f.jsx)("img",{className:M.a.image,src:t,alt:""}),Object(f.jsx)("div",{className:M.a.text,children:n})]})};var V=function(e){var t=e.imageUrl,n=e.text,i=e.action,a=Object(o.useRef)(null);return Object(f.jsxs)("div",{className:M.a.wrap,onClick:function(){a.current&&a.current.click()},children:[Object(f.jsx)("input",{type:"file",hidden:!0,accept:"image/png, image/gif, image/jpeg",ref:a,onChange:function(e){var t=e.target.files[0],n=new FileReader;n.readAsDataURL(t),n.onload=function(){i(n.result)},e.target.value=null}}),Object(f.jsx)("img",{className:M.a.image,src:t,alt:""}),Object(f.jsx)("div",{className:M.a.text,children:n})]})};var Y=function(e){var t=e.addTriangle,n=e.addRectangle,i=e.addEllipse,a=e.addImage,o=e.canUndo,c=e.undo,r=e.canRedo,s=e.redo;return Object(f.jsxs)("div",{className:S.a.wrap,children:[Object(f.jsxs)(L,{text:"Insert",indent:15,children:[Object(f.jsx)(W,{imageUrl:"images/triangle.png",text:"Triangle",action:t}),Object(f.jsx)(W,{imageUrl:"images/rectangle.png",text:"Rectangle",action:n}),Object(f.jsx)(W,{imageUrl:"images/ellipse.png",text:"Ellipse",action:i}),Object(f.jsx)(V,{imageUrl:"images/image.png",text:"Image",action:a})]}),Object(f.jsxs)("div",{className:S.a.history,children:[Object(f.jsx)("img",{className:o()?S.a.image+" "+S.a.imageUndo+" "+S.a.imageHoverUndo:S.a.image+" "+S.a.imageUndo+" "+S.a.withOpacity,src:"images/undo.png",alt:"",onClick:function(){c()}}),Object(f.jsx)("img",{className:r()?S.a.image+" "+S.a.imageRedo+" "+S.a.imageHoverRedo:S.a.image+" "+S.a.imageRedo+" "+S.a.withOpacity,src:"images/redo.png",alt:"",onClick:function(){s()}})]})]})};var B=function(e){var t=e.selectItem,n=e.setSelectItem,i=e.addRectangle,a=e.addEllipse,c=e.addTriangle,r=e.deleteItem,s=e.canUndo,u=e.undo,l=e.canRedo,h=e.redo,d=function(e){"Delete"===e.key&&t&&(r(t.GetId()),n(null)),"KeyR"===e.code&&i(),"KeyE"===e.code&&a(),"KeyT"===e.code&&c(),"KeyZ"===e.code&&s()&&u(),"KeyY"===e.code&&l()&&h()};return Object(o.useEffect)((function(){return document.addEventListener("keyup",d),function(){document.removeEventListener("keyup",d)}})),Object(f.jsx)(f.Fragment,{})};var K=function(e){var t=e.controller,n=e.items,i=function(){t.AddShape("Triangle")},a=function(){t.AddShape("Rectangle")},c=function(){t.AddShape("Ellipse")},r=function(){return t.CanUndo()},s=function(){t.CanUndo()&&t.Undo()},l=function(){return t.CanRedo()},d=function(){t.CanRedo()&&t.Redo()},v=Object(o.useState)(null),m=Object(u.a)(v,2),p=m[0],j=m[1];return Object(f.jsxs)("div",{children:[Object(f.jsx)(B,{selectItem:p,setSelectItem:j,addTriangle:i,addRectangle:a,addEllipse:c,deleteItem:function(e){t.DeleteItem(e)},canUndo:r,undo:s,canRedo:l,redo:d}),Object(f.jsx)(Y,{addTriangle:i,addRectangle:a,addEllipse:c,addImage:function(e){t.AddImage(e)},canUndo:r,undo:s,canRedo:l,redo:d}),Object(f.jsx)("div",{className:h.a.canvasWrap,children:Object(f.jsx)(P,{selectItem:p,setSelectItem:j,items:n,resizeItem:function(e,n){t.ResizeItem(e,n)},moveItem:function(e,n){t.MoveItem(e,n)}})})]})},X=function(){function e(){Object(i.a)(this,e),this.MAX_DEPTH_OF_HISTORY=20,this.undo=[],this.redo=[]}return Object(a.a)(e,[{key:"CanRedo",value:function(){return this.redo.length>0}},{key:"CanUndo",value:function(){return this.undo.length>0}},{key:"Redo",value:function(){if(!this.CanRedo())throw Error("the redo operation cannot be applied");var e=this.redo.pop();void 0!==e&&(this.undo.push(e),e.Execute())}},{key:"Undo",value:function(){if(!this.CanUndo())throw Error("the undo operation cannot be applied");var e=this.undo.pop();void 0!==e&&(this.redo.push(e),e.UnExecute())}},{key:"ExecuteCommand",value:function(e){e.Execute(),this.AddExecutedCommand(e)}},{key:"AddExecutedCommand",value:function(e){this.redo=[],this.undo.length>=this.MAX_DEPTH_OF_HISTORY&&this.undo.shift(),this.undo.push(e)}}]),e}(),J=n(5),Z=n(4),q=function(){function e(){Object(i.a)(this,e),this.executed=!1}return Object(a.a)(e,[{key:"Execute",value:function(){this.DoExecute(),this.executed=!0}},{key:"UnExecute",value:function(){if(this.IsExecuted())return this.DoUnExecute(),void(this.executed=!1);throw Error("canceling the command before it is executed")}},{key:"IsExecuted",value:function(){return this.executed}}]),e}(),Q=n(28),$=function(){function e(){Object(i.a)(this,e),this.frame=void 0,this.type=void 0,this.id=void 0,this.frame={leftTopPoint:{x:50,y:50},width:200,height:100}}return Object(a.a)(e,[{key:"GetType",value:function(){return this.type}},{key:"GetId",value:function(){return this.id}},{key:"GetFrame",value:function(){return this.frame}},{key:"Move",value:function(e){this.frame.leftTopPoint=e}},{key:"Resize",value:function(e){this.frame.width=e.width,this.frame.height=e.height}}]),e}(),ee=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).type=x.Rectangle,e.id=Object(Q.a)(),e}return Object(a.a)(n)}($),te=ee,ne=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).type=x.Triangle,e.id=Object(Q.a)(),e}return Object(a.a)(n)}($),ie=ne,ae=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).type=x.Ellipse,e.id=Object(Q.a)(),e}return Object(a.a)(n)}($),oe=ae,ce=function(){function e(){Object(i.a)(this,e)}return Object(a.a)(e,null,[{key:"CreateShape",value:function(e){if("Rectangle"===e)return new te;if("Triangle"===e)return new ie;if("Ellipse"===e)return new oe;throw Error("incorrect shape type")}}]),e}(),re=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e,a){var o;return Object(i.a)(this,n),(o=t.call(this)).shapes=void 0,o.shape=void 0,o.shapes=e,o.shape=ce.CreateShape(a),o}return Object(a.a)(n,[{key:"DoExecute",value:function(){this.shapes.push(this.shape)}},{key:"DoUnExecute",value:function(){this.shapes.pop()}}]),n}(q),se=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e,a){var o;return Object(i.a)(this,n),(o=t.call(this)).shapes=void 0,o.position=0,o.shape=null,o.shapes=e,o.position=o.shapes.findIndex((function(e){return e.GetId()===a})),o}return Object(a.a)(n,[{key:"DoExecute",value:function(){if(this.position>-1)return this.shape=this.shapes[this.position],void this.shapes.splice(this.position,1);throw Error("incorrect id specified")}},{key:"DoUnExecute",value:function(){this.shape&&this.shapes.splice(this.position,0,this.shape)}}]),n}(q),ue=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e,a,o){var c;return Object(i.a)(this,n),(c=t.call(this)).shapes=void 0,c.shape=void 0,c.newSize=void 0,c.oldSize={width:0,height:0},c.shapes=e,c.newSize=a,c.shape=c.shapes.find((function(e){return e.GetId()===o})),c}return Object(a.a)(n,[{key:"DoExecute",value:function(){this.oldSize=this.shape?{width:this.shape.GetFrame().width,height:this.shape.GetFrame().height}:this.oldSize,this.shape.Resize(this.newSize)}},{key:"DoUnExecute",value:function(){this.shape.Resize(this.oldSize)}}]),n}(q),le=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e,a,o){var c;return Object(i.a)(this,n),(c=t.call(this)).shapes=void 0,c.shape=void 0,c.newPoint=void 0,c.oldPoint={x:0,y:0},c.shapes=e,c.newPoint=a,c.shape=c.shapes.find((function(e){return e.GetId()===o})),c}return Object(a.a)(n,[{key:"DoExecute",value:function(){this.oldPoint=this.shape?this.shape.GetFrame().leftTopPoint:this.oldPoint,this.shape.Move(this.newPoint)}},{key:"DoUnExecute",value:function(){this.shape.Move(this.oldPoint)}}]),n}(q),he=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this)).path=void 0,a.id=Object(Q.a)(),a.type=x.Image,a.path=e,a}return Object(a.a)(n,[{key:"GetPath",value:function(){return this.path}}]),n}($),de=function(e){Object(J.a)(n,e);var t=Object(Z.a)(n);function n(e,a,o){var c;return Object(i.a)(this,n),(c=t.call(this)).shapes=void 0,c.shape=void 0,c.shapes=e,c.shape=new he(o),c}return Object(a.a)(n,[{key:"DoExecute",value:function(){this.shapes.push(this.shape)}},{key:"DoUnExecute",value:function(){this.shapes.pop()}}]),n}(q),fe=function(){function e(){Object(i.a)(this,e),this.items=[],this.history=void 0,this.observers=[],this.history=new X}return Object(a.a)(e,[{key:"GetItems",value:function(){return this.items}},{key:"AddShape",value:function(e){var t=new re(this.items,e);this.ExecuteCommand(t)}},{key:"AddImage",value:function(e){var t=new de(this.items,"Image",e);this.ExecuteCommand(t)}},{key:"DeleteItem",value:function(e){var t=new se(this.items,e);this.ExecuteCommand(t)}},{key:"ResizeItem",value:function(e,t){var n=new ue(this.items,t,e);this.ExecuteCommand(n)}},{key:"MoveItem",value:function(e,t){var n=new le(this.items,t,e);this.ExecuteCommand(n)}},{key:"CanUndo",value:function(){return this.history.CanUndo()}},{key:"Undo",value:function(){this.history.Undo(),this.NotifyObservers()}},{key:"CanRedo",value:function(){return this.history.CanRedo()}},{key:"Redo",value:function(){this.history.Redo(),this.NotifyObservers()}},{key:"RegisterObserver",value:function(e){this.observers.push(e)}},{key:"RemoveObserver",value:function(e){this.observers.filter((function(t){return t!==e}))}},{key:"NotifyObservers",value:function(){this.observers.forEach((function(e){return e.Update()}))}},{key:"ExecuteCommand",value:function(e){this.history.ExecuteCommand(e),this.NotifyObservers()}}]),e}(),ve=fe,me=function(){function e(t){Object(i.a)(this,e),this.model=void 0,this.model=t}return Object(a.a)(e,[{key:"GetItems",value:function(){return this.model.GetItems()}},{key:"AddShape",value:function(e){this.model.AddShape(e)}},{key:"AddImage",value:function(e){this.model.AddImage(e)}},{key:"DeleteItem",value:function(e){this.model.DeleteItem(e)}},{key:"ResizeItem",value:function(e,t){this.model.ResizeItem(e,t)}},{key:"MoveItem",value:function(e,t){this.model.MoveItem(e,t)}},{key:"CanUndo",value:function(){return this.model.CanUndo()}},{key:"Undo",value:function(){this.model.Undo()}},{key:"CanRedo",value:function(){return this.model.CanRedo()}},{key:"Redo",value:function(){this.model.Redo()}}]),e}(),pe=function(){function e(t){Object(i.a)(this,e),this.func=void 0,this.func=t}return Object(a.a)(e,[{key:"Update",value:function(){this.func()}}]),e}(),je=new ve,ge=new me(je),be=s.a.createRoot(document.getElementById("root"));function xe(){be.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(K,{items:je.GetItems(),controller:ge})}))}var Oe=new pe(xe);je.RegisterObserver(Oe),xe()}],[[27,1,2]]]);
//# sourceMappingURL=main.732854ba.chunk.js.map